{% extends 'base.html' %}

{% from "_macros/components.html" import accordion_button, custom_link %}

{% block title %}Course Assign Tools{% endblock %}

{% block content %}
<div class="container text-center justify-content-center">
	<h3>Course Assign Validation Tools</h3>
	<form method="POST" enctype="multipart/form-data">
		<div class="row">
			{{ form.csrf_token }}
			{% set file_label = form.file.label(class="form-label") %}
			{{ file_label }}
			{% set file_form = form.file(class="form-control") %}
			{{ file_form }}
		</div>
		<!-- <form method="POST" -->
		<div class="row row-cols-auto mt-2 justify-content-center">
			<div class="col align-self-center mt-2">
				{{ form.missing_course_grade_level(class="btn btn-outline-primary") }}
			</div>

			<div class="col align-self-center mt-2">
				{{ form.missing_edssn(class="btn btn-outline-primary") }}
			</div>

			<div class="col align-self-center mt-2">
				{{ form.missing_course_num(class="btn btn-outline-primary") }}
			</div>

			<div class="col align-self-center mt-2">
				{{ form.missing_course_sem(class="btn btn-outline-primary") }}
			</div>

			<div class="col align-self-center mt-2">
				{{ form.duplicate_assign_num(class="btn btn-outline-primary") }}
			</div>
		</div>
	</form>

	{% if results %}
	<div class="card mt-4">
		<div class="card-header d-flex flex-column flex-md-row justify-content-between gap-2">
			<div>
				<div class="fw-semibold text-start">{{ results.title }}</div>
				{% if results.filename %}
				<div class="small text-muted text-start">Source file: {{ results.filename }}</div>
				{% endif %}
			</div>
			{% if results.count is not none %}
			<span class="badge text-bg-secondary align-self-start align-self-md-center">
				{{ results.count }}
			</span>
			{% endif %}
		</div>

		<div class="card-body">
			{% if results.rows %}
			<div class="table-responsive">
				<table class="table table-striped table-sm align-middle mb-0">
					<thead>
						<tr>
							{% for column in results.columns %}
							<th scope="col">{{ column }}</th>
							{% endfor %}
						</tr>
					</thead>
					<tbody>
						{% for row in results.rows %}
						<tr>
							{% for column in results.columns %}
							<td>{{ row[column] }}</td>
							{% endfor %}
						</tr>
						{% endfor %}
					</tbody>
				</table>
			</div>
			{% else %}
			<p class="mb-0">{{ results.empty_message or 'No issues were found.' }}</p>
			{% endif %}
		</div>

	</div>
	{% endif %}
</div>



<script nonce={{ csp_nonce }}>
</script>

{% endblock %}
